(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{3111:(e,a,t)=>{Promise.resolve().then(t.bind(t,7135))},5269:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var r=t(5155),o=t(6874),s=t.n(o);let l=e=>{let{href:a="#",children:t}=e,o=(0,r.jsx)("div",{className:"flex cursor-pointer",children:(0,r.jsxs)("div",{className:"relative bg-[#D9D9D938]/78 lg:px-6 px-4 py-3 text-center lg:min-w-[200px] whitespace-nowrap",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 h-[1px] flex",children:[...Array(15)].map((e,a)=>(0,r.jsx)("div",{className:"h-full bg-[#a89a84]",style:{width:"".concat(8*Math.random()+4,"px"),marginRight:"".concat(8*Math.random()+4,"px")}},a))}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-[1px] flex",children:[...Array(15)].map((e,a)=>(0,r.jsx)("div",{className:"h-full bg-[#a89a84]",style:{width:"".concat(8*Math.random()+4,"px"),marginRight:"".concat(8*Math.random()+4,"px")}},a))}),(0,r.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-[1px] flex flex-col",children:[...Array(8)].map((e,a)=>(0,r.jsx)("div",{className:"w-full bg-[#a89a84]",style:{height:"".concat(8*Math.random()+4,"px"),marginBottom:"".concat(8*Math.random()+4,"px")}},a))}),(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-[1px] flex flex-col",children:[...Array(8)].map((e,a)=>(0,r.jsx)("div",{className:"w-full bg-[#a89a84]",style:{height:"".concat(8*Math.random()+4,"px"),marginBottom:"".concat(8*Math.random()+4,"px")}},a))}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-2 h-2 border-t border-l border-[#a89a84]"}),(0,r.jsx)("div",{className:"absolute top-0 right-0 w-2 h-2 border-t border-r border-[#a89a84]"}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 w-2 h-2 border-b border-l border-[#a89a84]"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-0 w-2 h-2 border-b border-r border-[#a89a84]"}),(0,r.jsx)("p",{className:"text-[#a89a84] font-orbitron font-bold",children:t})]})});return a?(0,r.jsx)(s(),{href:a,passHref:!0,legacyBehavior:!0,children:(0,r.jsx)("a",{rel:"noopener noreferrer",children:o})}):o}},7135:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var r=t(5155),o=t(2115),s=t(5269),l=t(8999);let n=()=>{let e="http://localhost:1323/api",a="".concat(e,"/auth?redirect_uri=").concat(encodeURIComponent("/quiz")),t=(0,l.useRouter)(),[n,c]=(0,o.useState)(null),[i,h]=(0,o.useState)(!0),d=async a=>{try{let t=await fetch("".concat(e,"/auth/me"),{headers:{Authorization:"Bearer ".concat(a)}});if(!t.ok)throw Error("Access token invalid");let r=await t.json();c(r),h(!1)}catch(e){throw e}},m=async a=>{try{let t=await fetch("".concat(e,"/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(!t.ok)throw Error("Refresh token invalid");let{accessToken:r,refreshToken:o}=await t.json();return sessionStorage.setItem("accessToken",r),localStorage.setItem("refreshToken",o),r}catch(e){return null}};return((0,o.useEffect)(()=>{let e=new URLSearchParams(window.location.search),a=e.get("accessToken"),r=e.get("refreshToken");a&&r&&(sessionStorage.setItem("accessToken",a),localStorage.setItem("refreshToken",r),t.replace("/quiz")),h(!1)},[t]),(0,o.useEffect)(()=>{console.log("checking tokens..."),(async()=>{let e=sessionStorage.getItem("accessToken"),a=localStorage.getItem("refreshToken");if(e){console.log("found accessToken");try{await d(e);return}catch(e){}}else if(a){console.log("found refreshToken");let e=await m(a);if(e)try{await d(e);return}catch(e){}}h(!1)})()},[e]),i)?(0,r.jsx)("p",{children:"Loading..."}):n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("h2",{children:["Welcome, ",n.name,"!"]}),(0,r.jsxs)("p",{children:["Email: ",n.email]})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.A,{href:a,children:"Sign in with Google"})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[874,441,684,358],()=>a(3111)),_N_E=e.O()}]);